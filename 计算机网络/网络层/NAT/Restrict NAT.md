Restrict NAT（地址限制型NAT）是一种比 Full Cone NAT **更严格、更安全**的网络地址转换类型。它的核心特点是：一旦内部地址和外部地址建立映射，==只有**之前通信过的那个外部地址**才能向内部地址发送数据。==

你可以把 Restrict NAT 想象成一个**“只认熟人”的大门**。

- **你（内部设备）**：你从屋子里发出一封信给一个朋友（外部主机 A）。
    
- **路由器（Restrict NAT）**：你的前门。它会创建一个公网映射。
    
- **Restrict NAT的规则**：这个大门只允许你的朋友（外部主机 A）给你回信。即使另一个朋友（外部主机 B）知道你的公网地址，它也无法直接给你发信。
    

### 工作原理

当你的电脑（私有地址：`192.168.1.10:5000`）第一次向外部服务器 A（公网地址：`1.2.3.4:80`）发送数据包时，Restrict NAT 路由器会执行以下操作：

1. 它会为你的内部地址创建一个固定的**公网映射**，比如 `203.0.113.10:60000`。
    
2. 它会向外部服务器 A 发送数据，并把源地址改为这个公网映射地址。
    
3. 最关键的一步是：这个映射只允许**来自外部服务器 A** 的数据包返回给你。如果另一个外部服务器 B 试图向 `203.0.113.10:60000` 发送数据，路由器会将其丢弃。
    

### 核心特性：限制来源地址

Restrict NAT 的关键特性是==**它限制了返回数据的源地址**。只有你主动发起过通信的外部设备，才有权限向你的公网映射地址发送数据。==

- **优点**：安全性更高。它有效地阻止了来自未授权外部设备的意外连接或恶意攻击，是一种更安全的NAT类型。
    
- **缺点**：对**点对点（P2P）通信**造成了障碍。在很多P2P应用中，一个设备需要通过一个中介服务器来发现另一个设备，然后直接与其通信。==Restrict NAT 的这种限制会阻止这种直接通信，因为对端设备的IP地址可能与中介服务器的IP地址不同。==
    

### 为什么它叫“地址限制型”？

“地址限制”这个名字完美地描述了它的工作方式：它对可以返回数据的**源IP地址**进行了严格的限制。

### 总结

Restrict NAT 是一种对安全性有更高要求的NAT类型。==它通过只允许来自已通信过的外部IP地址的数据包返回，来保护内部网络。==虽然这增加了安全性，但同时也增加了点对点通信的难度。

---

在P2P通信中，为了克服 Restrict NAT 的限制，通常需要依赖更复杂的协议，比如**ICE**，它会尝试各种方法来建立连接。