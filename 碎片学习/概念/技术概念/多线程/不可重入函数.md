在实时系统的设计中，经常会出现多个任务调用同一个函数的情况。如果有一个函数不幸被设计成为这样==：那么不同任务调用这个函数时可能修改其他任务调用这个函数的数据，从而导致不可预料的后果。==**这样的函数是不安全的函数，也叫不可重入函数**。

不可重入的函数由于使用了一些系统资源，比如全局变量区，中断向量表等，所以它如果被中断的话，可能会出现问题，这类函数是不能运行在多任务环境下的。

也可以这样理解，==重入即表示重复进入，首先它意味着这个函数可以被中断，其次意味着它除了使用自己栈上的变量以外不依赖于任何环境==（包括 static），这样的函数就是purecode（纯代码）可重入，可以允许有该函数的多个副本在运行，由于它们使用的是分离的栈，所以不会互相干扰。==如果确实需要访问全局变量（包括 static），一定要注意实施互斥手段==。可重入函数在并行运行环境中非常重要，但是一般要为访问全局变量付出一些性能代价。

编写可重入函数时，若使用全局变量，则应通过关中断、信号量（即P、V操作）等手段对其加以保护。

说明：若对所使用的全局变量不加以保护，则此函数就不具有可重入性，即当多个进程调用此函数时，很有可能使有关全局变量变为不可知状态。

## 不可重入函数改造
如何将一个不可重入的函数改写成可重入函数呢？把一个不可重入函数变成可重入的唯一方法是用可重入规则来重写它。其实很简单，只要遵守了几条很容易理解的规则，那么写出来的函数就是可重入的：

1）不要使用全局变量。因为别的代码很可能改变这些变量值。
2）在和硬件发生交互的时候，==切记执行类似 disinterrupt() 之类的操作，就是关闭硬件中断。==完成交互记得打开中断，在有些系列上，这叫做“进入/ 退出核心”。
3）不能调用其它任何不可重入的函数。
4）谨慎使用堆栈。