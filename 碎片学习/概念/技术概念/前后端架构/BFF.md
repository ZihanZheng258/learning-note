[BFF](https://samnewman.io/patterns/architectural/bff) —— Backends for frontends（服务于前端的后端），==是为了让后端API满足不同的前端使用场景，而演进出来的一种模式。==BFF在改善前端用户体验上起到了非常大的作用，但因为介于前端和后端之间，在落地实施过程中很容易踩坑，在这篇文章中，我们看看在实施BFF的过程中可能遇到哪些“坑”。为了帮助快速理解后面讲到的问题，我们先来简单回顾下BFF的由来和应用场景。


## BFF的由来

随着移动设备的快速发展以及产品对用户交互体验的关注度增强，前后端分离的架构模式也逐渐被大多数企业所采用。在这种模式下，==统一的后端API很难满足在不同场景下对用户体验的不同需求。==

BFF是一种Web架构，微服务设计系列丛书的作者 Sam Newman曾在他的博客中写了一篇相关文章《Pattern: Backends For Frontends》

==服务端设计API时会考虑到不同设备的需求，即为不同设备提供不同API接口==，虽然它们可能实现相同功能，但因不同设备的特殊性，它们对服务端的API访问也各有其特点，需区别处理。在计算机科学中，所有问题都可以通过加一层来解决，于是 BFF 架构设计应运而生

BFF模式应运而生，==一方面BFF隔离了前端UI展示对后端API的需求，企业可以专注在后端构建核心业务能力==，另一方面，BFF根据已有的后端API，快速满足前端在UI展示上的需求，来不断提升用户体验；

从知识管理的角度，==BFF模式让知识边界定义得更清晰，后端专注于构建业务能力==，不需要考虑前端各种场景适配的问题；而前端更关注用户体验，可以随时独立发布更新。

### 面向前端 

BFF为前端而生，==随着前端技术（iOS、Android、小程序、Web等）的不断发展，不同前端对后端要求有很大差异，后端服务很难提供满足多个前端的统一接口==，BFF则可以针对前端的特定需求，作出适配：

- 针对前端UI展示逻辑的不同，对后端API返回的数据进行裁剪和重新组织，提供面向前端的定制化格式的数据
- 根据前端业务需求，==对后端多个API返回的数据进行聚合==
- 对一些特定场景的数据进行缓存，提高性能，进而提升用户体验

### 面向后端

==BFF隔离了前端UI展示对后端API的定制化需求，可以很好地支持后端服务的演进==：

- 从单体应用迁移到微服务架构，后端架构的演进可以通过BFF来进行隔离，参见[《 前后端分离演进：不能微服务，那就 BFF 隔离 》](https://www.phodal.com/blog/architecture-101-bff-for-legacy-system-migrate/)。

- 微服务架构内部的演进，微服务的拆分，也可以借助BFF来减少对前端的影响，参见我的另外一篇文章[《迭代开发中的微服务拆分》](https://www.maguangguang.xyz/services-split-in-iterative-development)。

## BFF实现中的坑

==BFF模式在前后端分离的架构模式下的确有很多好处，完美隔离了前后端，貌似从此以后前端干前端的，后端干后端的，大大降低前后端之间的冲突和依赖==。然而事实并非如此，在实施BFF的过程中，大家仍然会遇到各种问题，我总结了实施落地BFF的三大常见问题如下：