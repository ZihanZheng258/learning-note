高斯背景建模（Gaussian Mixture Model for Background Subtraction），==简称 **GMM**，是计算机视觉领域中一种非常经典和高效的**前景检测**方法。==

它的核心目的是：**将视频序列中相对静止的“背景”与正在移动的“前景”（如人、车辆）分离开来。**

## 核心原理：高斯混合模型 (GMM)

### 1. 为什么不能用单一高斯模型？

在一个简单的静态场景中，一个像素点的颜色或亮度值在一段时间内可能只围绕一个固定的平均值波动，==这种波动可以用一个**单一的高斯分布**（即正态分布）来描述==。

但是，在现实世界的视频中，背景往往是**动态的**，比如：

- **重复运动：** 树叶的摇晃、旗帜的飘动、流水、交通灯颜色的切换。
    
- **光线变化：** 云层遮挡太阳导致的光影变化。
    

这些动态背景导致一个像素的值在时间上可能围绕==**多个**不同的平均值波动。单一的高斯分布无法准确描述这种复杂的像素值分布。==

### 2. GMM 的解决之道

**高斯混合模型（GMM）** 允许每个像素点的历史像素值（如亮度或颜色）被建模为 **多个** 高斯分布的**加权和（Mixture）**：

![[Pasted image 20250926163823.png]]

- P(x): 某一时刻像素值 x 出现的概率。
    
- K: 高斯分布的总数（通常为 3 到 5 个）。
    
- wk​: ==第 k 个高斯分布的**权重**（Weight），表示该分布出现的频率。==
    
- N(⋅): 第 k 个高斯分布（由**均值 μk​** 和**方差 Σk​** 描述）。
    

**每个高斯分量代表了该像素点可能处于的一种状态。** 例如，对于一个交通灯的像素点：

- 第一个高斯分量可能代表“红灯”时的像素值分布。
    
- 第二个高斯分量可能代表“绿灯”时的像素值分布。


## GMM 的工作流程

高斯背景建模主要分为初始化、匹配和分类三个步骤：

### 1. 训练与自适应（Adaptive Learning）

- **模型初始化：** ==视频开始时，每个像素都初始化一组小的（K 个）高斯分量，并给它们分配初始的均值、方差和权重。==
    
- **模型更新：** 随着视频帧不断进入，每个像素的 GMM 参数都会被**迭代更新**==（通常使用如 EM 算法或指数衰减学习率等自适应方法），以反映背景随时间的变化。==

### 2. 像素匹配与前景判断

对于视频中的新一帧图像，算法对**每个像素**执行以下操作：

1. 计算当前像素值与该 GMM 中**所有高斯分量**的匹配程度。
    
2. 如果像素值落在某个高斯分量的 2∼3 倍标准差（即 2∼3⋅σ) 范围内，==则认为该像素与该分量**匹配**。==
    

### 3. 背景与前景分类

- **背景判定：** 算法通常会将那些**权重高**（出现频率高）==且**方差小**（分布稳定）的少数几个高斯分量视为**背景模型**。==
    
    - 通常会按 wk​/σk​ 的比值对高斯分量进行排序，并累加它们的权重，==直到达到一个预设的背景阈值（例如 70% 或 80%）。==
        
    - 如果当前像素值与这些被选定的“背景”高斯分量中的**任何一个**匹配，则该像素被分类为**背景（Background）**。
        
- **前景判定：** 如果当前像素值与所有被定义为背景的高斯分量都**不匹配**，==则该像素被分类为**前景（Foreground）**==。
    

最终输出是一个**二值图像（Foreground Mask）**，其中前景部分为白色，背景部分为黑色，从而实现了动静物体的分离。

## GMM 的优点

- **处理动态背景：** 这是 GMM 最突出的优势，它能处理树叶摇晃、==波纹等周期性或非周期性的背景变化。==
    
- **自适应性：** GMM 可以通过持续的更新机制来适应缓慢变化的场景（如日照强度的渐变）。
    

GMM 的经典改进算法，例如 **BackgroundSubtractorMOG2**，在现代计算机视觉库（如 OpenCV）中被广泛应用。
