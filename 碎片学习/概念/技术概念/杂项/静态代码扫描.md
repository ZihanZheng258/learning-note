### 什么是静态代码扫描？

**静态代码扫描**，也称为 **SAST** (Static Application Security Testing)，是一种在不运行程序的情况下，对源代码、字节码或二进制代码进行检查的技术。它的核心思想就像是代码的“语法和拼写检查”，可以在代码被部署到生产环境之前，快速找出潜在的**安全漏洞**、**编程错误**和**编码规范问题**。

### 工作原理

静态代码扫描工具通过以下几种方式来分析代码：

- **语法和语义分析**：工具会解析代码的语法结构和语义，理解程序的逻辑流程。
    
- **数据流分析**：跟踪数据在程序中的流动路径，以检测是否存在不安全的数据使用，例如从用户输入到数据库查询的未净化数据。
    
- **控制流分析**：分析程序的执行路径，以识别死循环、不可达代码或不合理的逻辑。
    

整个过程不需要编译和运行代码，因此可以在开发周期的任何阶段进行，例如在代码提交到版本控制系统之前。

### 它能发现什么问题？

静态代码扫描工具可以识别多种类型的问题，包括但不限于：

- **安全漏洞**：
    
    - **SQL 注入**：未经过滤的用户输入被用于构建 SQL 查询。
        
    - **跨站脚本 (XSS)**：在网页中注入恶意脚本。
        
    - **硬编码凭据**：在源代码中直接写入密码或 API 密钥。
        
    - **不安全的加密算法**：使用已知的弱加密算法。
        
- **编程错误**：
    
    - 空指针引用。
        
    - 资源泄露（例如未关闭的文件句柄或数据库连接）。
        
    - 死代码或无用代码。
        
- **编码规范和风格问题**：
    
    - 不符合团队约定的命名规则。
        
    - 代码格式不一致。
        
- **合规性问题**：
    
    - 不符合 GDPR、PCI DSS 等行业标准的安全实践。
        

### 主要优点

- **提前发现问题**：在开发阶段就能发现问题，修复成本远低于在生产环境中发现。
    
- **提高代码质量**：强制执行编码规范，减少错误和技术债务。
    
- **自动化和集成**：可以集成到 CI/CD (持续集成/持续交付) 流程中，实现自动化扫描。
    
- **成本效益**：与手动代码审查相比，静态扫描更快速、更便宜。
    

### 局限性

虽然功能强大，但静态代码扫描也有其局限性：

- **无法检测运行时错误**：它无法模拟实际程序运行时的状态，因此无法发现只有在运行时才能出现的逻辑错误或性能问题。
    
- **误报（False Positives）**：有时会标记一些实际上不是漏洞的代码，需要人工进行复查和确认。
    
- **无法理解上下文**：工具可能无法完全理解复杂的业务逻辑，导致遗漏一些基于特定逻辑的漏洞。
    

因此，静态代码扫描通常作为全面安全测试策略的一部分，与动态代码分析（DAST）、渗透测试等方法结合使用。