==强大的身份验证和建立的用户身份是 Hadoop 安全访问的基础。用户需要能够可靠地“识别”自己，然后在整个 Hadoop 集群中传播身份==。完成此操作后，这些用户可以访问资源（例如文件或目录）或与集群交互（如运行 MapReduce 作业）。除了用户之外，Hadoop 集群资源本身（例如主机和服务）需要相互进行身份验证，轴向的恶意系统或守护程序“冒充”受信任的集群组件来获取数据访问权限。

Hadoop使用**Kerberos**作为**用户和服务的强身份验证和身份传播**的基础。K==erberos**是一种网络认证协议，它允许计算机某实体在非安全的网络环境下通信，向另一个实体以一种安全的方式证明自己的身份==。Kerberos**是第三方认证机制，其中用户和服务依赖于第三方（Kerberos服务器）来对各方进行身份验证。Kerberos**服务器**本身称为**中继中心或KDC**。在上面的上面，它有三个部分：

- ==它知道用户和服务（称为**主体**）及其各自的 Kerberos 密码的数据库。==
- 一个**认证服务器（Authentication Server，简称AS）：验证Client端的身份（确定你是身份证上的身份），验证通过就会给一张票证领取票证（Ticket Granting Ticket，简称TGT）给客户端。**
- 一个**授权服务器（Ticket Granting Server，简称 TGS）：通过 TGT（AS 发送给 Client 的票）获取访问服务器端的票（Server Ticket，简称 ST）。ST（Service Ticket）也有资料称为 TGS Ticket。**

![[Pasted image 20250623112102.png]]

一个主要用户来自 AS 请求认证。AS**返回**使用用户主体的 Kerberos 密码加密的**TGT**，该密码隐藏用户主体和 AS 相同。用户主体使用其 Kerberos 密码在本地解密 TGT，从那时起，直到**票据**相反，用户主体使用可以从 TGS 中的 TGT 获取服务令牌。**服务票证允许委托人访问服务。**

Kerberos简单来说就是一个用于安全认证的第三方协议，它采用传统的共享密钥的方式，在网络环境不一定保证安全的环境下实现了，客户端和服务器之间的通信，适用于客户端/服务器模型，由MIT开发和实现。

### **Kerberos 的关键安全机制**

- **不传输密码：** 用户密码只用于首次在客户端本地解密 AS 返回的 `Kc_tgs`。之后的所有交互都通过票据和会话密钥进行，密码从未在网络上传输。
- **时间戳和重放攻击保护：** 票据和验证器中都包含时间戳和有效期，KDC 和服务会检查这些时间戳来防止过期的票据被重放使用。
- **会话密钥：** 每次认证过程都会生成临时的、有效期短的会话密钥，用于客户端和服务器之间的数据加密，即使这些会话密钥被泄露，也只在有限时间内有效。
- **相互认证：** Kerberos 不仅让服务器验证客户端，也让客户端验证服务器，这防止了中间人攻击。
