
“容错性设计”（Design for Failure）是微服务的另一个[核心原则](https://icyfenix.cn/architecture/architect-history/microservices.html)，也是笔者书中多次反复强调的开发观念转变。不过，即使已经有一定的心理准备，大多数首次将微服务架构引入实际生产系统的开发者，在[服务发现](https://icyfenix.cn/distribution/connect/service-discovery.html)、[网关路由](https://icyfenix.cn/distribution/connect/service-routing.html)等支持下，踏出了服务化的第一步以后，很可能仍会经历一段阵痛期，随着拆分出的服务越来越多，随之而来会面临以下两个问题的困扰：

- ==由于某一个服务的崩溃，导致所有用到这个服务的其他服务都无法正常工作==，一个点的错误经过层层传递，最终波及到调用链上与此有关的所有服务，==这便是雪崩效应==。如何防止雪崩效应便是微服务架构容错性设计原则的具体实践，否则服务化程度越高，整个系统反而越不稳定。

- ==服务虽然没有崩溃，但由于处理能力有限，面临超过预期的突发请求时，大部分请求直至超时都无法完成处理==。这种现象产生的后果跟交通堵塞是类似的，如果一开始没有得到及时的治理，后面就需要长时间才能使全部服务都恢复正常。

Martin Fowler 与 James Lewis 提出的“[微服务的九个核心特征](https://icyfenix.cn/architecture/architect-history/microservices.html)”是构建微服务系统的指导性原则，==但不是技术规范，并没有严格的约束力。==在实际构建系统时候，其中多数特征可能会有或多或少的妥协，譬如分散治理、数据去中心化、轻量级通信机制、演进式设计，等等。==但也有一些特征是无法做出妥协的，其中的典型就是今天我们讨论的主题：容错性设计。==

容错性设计不能妥协源于分布式系统的本质是不可靠的，一个大的服务集群中，程序可能崩溃、节点可能宕机、网络可能中断，这些“意外情况”其实全部都在“意料之中”。原本信息系统设计成分布式架构的主要动力之一就是为了提升系统的可用性，==最低限度也必须保证将原有系统重构为分布式架构之后，可用性不出现倒退下降才行。==如果服务集群中出现任何一点差错都能让系统面临“千里之堤溃于蚁穴”的风险，那分布式恐怕就根本没有机会成为一种可用的系统架构形式。